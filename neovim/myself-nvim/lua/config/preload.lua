-- ============================================================================
-- 预加载配置文件
-- 此文件包含在初始化 Lazy.nvim 插件管理器之前需要加载的设置
-- 这些设置必须在插件加载前生效，以避免出现配置冲突或显示问题
-- ============================================================================

local Preload = {}

-- ----------------------------------------------------------------------------
-- 应用预加载配置
-- 此函数在插件管理器初始化前执行，设置关键的全局配置
-- ----------------------------------------------------------------------------
function Preload.apply()
    -- ------------------------------------------------------------------------
    -- Leader 键设置
    -- Leader 键是 Vim 中用于自定义快捷键的前缀键
    -- 这两个必须要先加载
    -- ------------------------------------------------------------------------
    vim.g.mapleader = ' '       -- 设置全局 Leader 键为空格键
    vim.g.maplocalleader = ' '  -- 设置本地 Leader 键为空格键（用于特定文件类型）

    -- ------------------------------------------------------------------------
    -- 行号和光标行高亮设置
    -- ------------------------------------------------------------------------
    -- 警告：这些设置必须放在这里，而不是 `options.lua` 中
    -- 原因：如果在插件加载后设置，会导致行号和光标行高亮
    --      在启动页面（dashboard）上显示，看起来很奇怪
    vim.opt.number = true       -- 显示行号（绝对行号）
    vim.opt.cursorline = true   -- 高亮显示当前光标所在行

    -- ------------------------------------------------------------------------
    -- 缩进和制表符设置
    -- ------------------------------------------------------------------------
    -- 注意：这些设置可能会被 ftplugin（文件类型插件）覆盖
    -- ftplugin 允许为不同文件类型设置不同的缩进规则
    vim.opt.tabstop = 4         -- 制表符（Tab）显示为 4 个空格的宽度
    vim.opt.shiftwidth = 4      -- 自动缩进时使用 4 个空格
    vim.opt.expandtab = true    -- 将 Tab 键转换为空格
    vim.opt.autoindent = true   -- 新行自动继承上一行的缩进
    vim.opt.smartindent = true  -- 智能缩进
    vim.opt.shiftround = true   -- 缩进取整到shiftwidth的倍数
end

-- 返回 Preload 模块，以便在 init.lua 中通过 require() 调用
return Preload